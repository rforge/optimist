<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Whittaker Smoothing — whittaker • pracma</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">pracma</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Whittaker Smoothing</h1>
    </div>

    
    <p>Smoothing of time series using the Whittaker-Henderson approach.</p>
    

    <pre class="usage"><span class='fu'>whittaker</span>(<span class='no'>y</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1600</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='fl'>2</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>signal to be smoothed.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>smoothing parameter (rough 50..1e4 smooth); the default
                value of 1600 has been recommended in the literature.</p></td>
    </tr>
    <tr>
      <th>d</th>
      <td><p>order of differences in penalty (generally 2)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The Whittaker smoother family was first presented by Whittaker in 
  1923 for life tables, based on penalized least squares. These ideas 
  were revived by Paul Eilers, Leiden University, in 2003. This
  approach is also known as Whittaker-Henderson smoothing.</p>
<p>The smoother attempts to both fit a curve that represents the raw 
  data, but is penalized if subsequent points vary too much.
  Mathematically it is a large, but sparse optimization problem that 
  can be expressed in a few lines of Matlab or R code.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A smoothed time series.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This is a version that avoids package 'SparseM'.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>P. H. C. Eilers (2003). A Perfect Smoother. Analytical Chemistry,
  Vol. 75, No. 14, pp. 3631--3636.</p>
<p>Wilson, D. I. (2006). The Black Art of Smoothing. Electrical and 
  Automation Technology, June/July issue.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code>supsmu</code>, <code><a href='savgol.html'>savgol</a></code>, <code>ptw::whit2</code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># **Sinosoid test function**</span>
<span class='no'>ts</span> <span class='kw'>&lt;-</span> <span class='fu'>sin</span>(<span class='fl'>2</span>*<span class='no'>pi</span>*(<span class='fl'>1</span>:<span class='fl'>1000</span>)/<span class='fl'>200</span>)
<span class='no'>t1</span> <span class='kw'>&lt;-</span> <span class='no'>ts</span> + <span class='fu'>rnorm</span>(<span class='fl'>1000</span>)/<span class='fl'>10</span>
<span class='no'>t3</span> <span class='kw'>&lt;-</span> <span class='fu'>whittaker</span>(<span class='no'>t1</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1600</span>)</div><span class='co'># NOT RUN {</span>
<span class='fu'>plot</span>(<span class='fl'>1</span>:<span class='fl'>1000</span>, <span class='no'>t1</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"grey"</span>)
<span class='fu'>lines</span>(<span class='fl'>1</span>:<span class='fl'>1000</span>, <span class='no'>ts</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"blue"</span>)
<span class='fu'>lines</span>(<span class='fl'>1</span>:<span class='fl'>1000</span>, <span class='no'>t3</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"red"</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
  An R version, based on Matlab code by P. Eilers in 2002, has been 
  published by Nicholas Lewin-Koh on the R-help mailing list in Feb. 
  2004, and in private communication to the author of this package.

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Hans Werner Borchers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>

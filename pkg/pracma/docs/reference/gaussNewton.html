<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Gauss-Newton Function Minimization — gaussNewton • pracma</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">pracma</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gauss-Newton Function Minimization</h1>
    </div>

    
    <p>Gauss-Newton method of minimizing a term \(f_1(x)^2 + \ldots + f_m(x)^2\)
  or \(F' F\) where \(F = (f_1, \ldots, f_m)\) is a multivariate function
  of \(n\) variables, not necessarily \(n = m\).</p>
    

    <pre class="usage"><span class='fu'>gaussNewton</span>(<span class='no'>x0</span>, <span class='no'>Ffun</span>, <span class='kw'>Jfun</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                        <span class='kw'>maxiter</span> <span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='no'>.Machine</span>$<span class='no'>double.eps</span>^(<span class='fl'>1</span>/<span class='fl'>2</span>), <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Ffun</th>
      <td><p><code>m</code> functions of <code>n</code> variables.</p></td>
    </tr>
    <tr>
      <th>Jfun</th>
      <td><p>function returning the Jacobian matrix of <code>Ffun</code>;
            if <code>NULL</code>, the default, the Jacobian will be computed
            numerically. The gradient of <code>f</code> will be computed
            internally from the Jacobian (i.e., cannot be supplied).</p></td>
    </tr>
    <tr>
      <th>x0</th>
      <td><p>Numeric vector of length <code>n</code>.</p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>Maximum number of iterations.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Tolerance, relative accuracy.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters to be passed to f.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Solves the system of equations applying the Gauss-Newton's method. It is
  especially designed for minimizing a sum-of-squares of functions and can
  be used to find a common zero of several function.</p>  
<p>This algorithm is described in detail in the textbook by Antoniou and Lu,
  incl. different ways to modify and remedy the Hessian if not being positive
  definite. Here, the approach by Goldfeld, Quandt and Trotter is used, and 
  the hessian modified by the Matthews and Davies algorithm if still not
  invertible.</p>
<p>To accelerate the iteration, an inexact linesearch is applied.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List with components:
  <code>xs</code> the minimum or root found so far,
  <code>fs</code> the square root of sum of squares of the values of f,
  <code>iter</code> the number of iterations needed, and
  <code>relerr</code> the absoulte distance between the last two solutions.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Antoniou, A., and W.-S. Lu (2007). Practical Optimization: Algorithms and
  Engineering Applications. Springer Business+Science, New York.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>If <code>n=m</code> then directly applying the <code>newtonsys</code> function might
  be a better alternative.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='newtonsys.html'>newtonsys</a></code>, <code><a href='softline.html'>softline</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>f1</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>c</span>(<span class='no'>x</span>[<span class='fl'>1</span>]^<span class='fl'>2</span> + <span class='no'>x</span>[<span class='fl'>2</span>]^<span class='fl'>2</span> - <span class='fl'>1</span>, <span class='no'>x</span>[<span class='fl'>1</span>] + <span class='no'>x</span>[<span class='fl'>2</span>] - <span class='fl'>1</span>)
<span class='fu'>gaussNewton</span>(<span class='fu'>c</span>(<span class='fl'>4</span>, <span class='fl'>4</span>), <span class='no'>f1</span>)</div><div class='output co'>#&gt; $xs
#&gt; [1] 0.6299606 0.6299606
#&gt; 
#&gt; $fs
#&gt; [1] 0.1101184
#&gt; 
#&gt; $niter
#&gt; [1] 5
#&gt; 
#&gt; $relerr
#&gt; [1] 9.200647e-10
#&gt; </div><div class='input'>
<span class='no'>f2</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>c</span>( <span class='no'>x</span>[<span class='fl'>1</span>] + <span class='fl'>10</span>*<span class='no'>x</span>[<span class='fl'>2</span>], <span class='fu'>sqrt</span>(<span class='fl'>5</span>)*(<span class='no'>x</span>[] - <span class='no'>x</span>[<span class='fl'>4</span>]),
                    (<span class='no'>x</span>[<span class='fl'>2</span>] - <span class='fl'>2</span>*<span class='no'>x</span>[<span class='fl'>3</span>])^<span class='fl'>2</span>, <span class='fl'>10</span>*(<span class='no'>x</span>[<span class='fl'>1</span>] - <span class='no'>x</span>[<span class='fl'>4</span>])^<span class='fl'>2</span>)
<span class='fu'>gaussNewton</span>(<span class='fu'>c</span>(-<span class='fl'>2</span>, -<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>2</span>), <span class='no'>f2</span>)</div><div class='output co'>#&gt; $xs
#&gt; [1] -5.217195e-26  3.035548e-27 -6.223334e-26 -4.143244e-26
#&gt; 
#&gt; $fs
#&gt; [1] 1.310304e-50
#&gt; 
#&gt; $niter
#&gt; [1] 7
#&gt; 
#&gt; $relerr
#&gt; [1] 3.376084e-17
#&gt; </div><div class='input'>
<span class='no'>f3</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>)
        <span class='fu'>c</span>(<span class='fl'>2</span>*<span class='no'>x</span>[<span class='fl'>1</span>] - <span class='no'>x</span>[<span class='fl'>2</span>] - <span class='fu'>exp</span>(-<span class='no'>x</span>[<span class='fl'>1</span>]), -<span class='no'>x</span>[<span class='fl'>1</span>] + <span class='fl'>2</span>*<span class='no'>x</span>[<span class='fl'>2</span>] - <span class='fu'>exp</span>(-<span class='no'>x</span>[<span class='fl'>2</span>]))
<span class='fu'>gaussNewton</span>(<span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>), <span class='no'>f3</span>)</div><div class='output co'>#&gt; $xs
#&gt; [1] 0.5671433 0.5671433
#&gt; 
#&gt; $fs
#&gt; [1] 0
#&gt; 
#&gt; $niter
#&gt; [1] 5
#&gt; 
#&gt; $relerr
#&gt; [1] 7.721235e-14
#&gt; </div><div class='input'><span class='co'># $xs   0.5671433 0.5671433</span>

<span class='no'>f4</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>)  <span class='co'># Dennis Schnabel</span>
        <span class='fu'>c</span>(<span class='no'>x</span>[<span class='fl'>1</span>]^<span class='fl'>2</span> + <span class='no'>x</span>[<span class='fl'>2</span>]^<span class='fl'>2</span> - <span class='fl'>2</span>, <span class='fu'>exp</span>(<span class='no'>x</span>[<span class='fl'>1</span>] - <span class='fl'>1</span>) + <span class='no'>x</span>[<span class='fl'>2</span>]^<span class='fl'>3</span> - <span class='fl'>2</span>)
<span class='fu'>gaussNewton</span>(<span class='fu'>c</span>(<span class='fl'>2.0</span>, <span class='fl'>0.5</span>), <span class='no'>f4</span>)</div><div class='output co'>#&gt; $xs
#&gt; [1] 1 1
#&gt; 
#&gt; $fs
#&gt; [1] 0
#&gt; 
#&gt; $niter
#&gt; [1] 8
#&gt; 
#&gt; $relerr
#&gt; [1] 5.104648e-10
#&gt; </div><div class='input'><span class='co'># $xs    1 1</span>

<span class='co'>##  Examples (from Matlab)</span>
<span class='no'>F1</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>c</span>(<span class='fl'>2</span>*<span class='no'>x</span>[<span class='fl'>1</span>]-<span class='no'>x</span>[<span class='fl'>2</span>]-<span class='fu'>exp</span>(-<span class='no'>x</span>[<span class='fl'>1</span>]), -<span class='no'>x</span>[<span class='fl'>1</span>]+<span class='fl'>2</span>*<span class='no'>x</span>[<span class='fl'>2</span>]-<span class='fu'>exp</span>(-<span class='no'>x</span>[<span class='fl'>2</span>]))
<span class='fu'>gaussNewton</span>(<span class='fu'>c</span>(-<span class='fl'>5</span>, -<span class='fl'>5</span>), <span class='no'>F1</span>)</div><div class='output co'>#&gt; $xs
#&gt; [1] 0.5671433 0.5671433
#&gt; 
#&gt; $fs
#&gt; [1] 0
#&gt; 
#&gt; $niter
#&gt; [1] 4
#&gt; 
#&gt; $relerr
#&gt; [1] 7.90904e-16
#&gt; </div><div class='input'>
<span class='co'># Find a matrix X such that X %*% X %*% X = [1 2; 3 4]</span>
<span class='no'>F2</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) {
    <span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='no'>x</span>, <span class='fl'>2</span>, <span class='fl'>2</span>)
    <span class='no'>D</span> <span class='kw'>&lt;-</span> <span class='no'>X</span> <span class='kw'>%*%</span> <span class='no'>X</span> <span class='kw'>%*%</span> <span class='no'>X</span> - <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>2</span>,<span class='fl'>4</span>), <span class='fl'>2</span>, <span class='fl'>2</span>)
    <span class='fu'>return</span>(<span class='fu'>c</span>(<span class='no'>D</span>))
}
<span class='no'>sol</span> <span class='kw'>&lt;-</span> <span class='fu'>gaussNewton</span>(<span class='fu'><a href='eye.html'>ones</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>), <span class='no'>F2</span>)
(<span class='no'>X</span>  <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='no'>sol</span>$<span class='no'>xs</span>, <span class='fl'>2</span>, <span class='fl'>2</span>))</div><div class='output co'>#&gt;            [,1]      [,2]
#&gt; [1,] -0.1291489 0.8602157
#&gt; [2,]  1.2903236 1.1611747</div><div class='input'><span class='co'>#            [,1]      [,2]</span>
<span class='co'># [1,] -0.1291489 0.8602157</span>
<span class='co'># [2,]  1.2903236 1.1611747</span>
<span class='no'>X</span> <span class='kw'>%*%</span> <span class='no'>X</span> <span class='kw'>%*%</span> <span class='no'>X</span></div><div class='output co'>#&gt;      [,1] [,2]
#&gt; [1,]    1    2
#&gt; [2,]    3    4</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Hans Werner Borchers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
